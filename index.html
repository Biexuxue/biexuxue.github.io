<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>观雪斋 - 传统</title>
    <script src="js/js-calendar-converter.js"></script>
    <link href="https://fonts.loli.net/css2?family=Noto+Serif+SC:wght@300;400;700&family=Ma+Shan+Zheng&family=ZCOOL+XiaoWei&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="style.css">
    <style>
        /* 添加悬停框样式 */
        .time-tooltip {
            position: absolute;
            top: calc(100% + 10px);
            right: 0;
            width: 320px;
            background-color: rgba(255, 255, 255, 0.98);
            border: 1px solid rgba(0, 0, 0, 0.08);
            border-radius: 12px;
            padding: 2rem;
            z-index: 2000;
            opacity: 0;
            visibility: hidden;
            transition: all 0.3s ease;
            box-shadow: 0 15px 35px rgba(0, 0, 0, 0.1);
            backdrop-filter: blur(10px);
            pointer-events: none;
        }
        
        .ancient-time {
            position: relative;
            cursor: pointer;
        }
        
        .ancient-time:hover .time-tooltip {
            opacity: 1;
            visibility: visible;
            transform: translateY(5px);
            pointer-events: auto;
        }
        
        .tooltip-header {
            font-family: 'Ma Shan Zheng', cursive;
            font-size: 1.8rem;
            color: #1a1a1a;
            margin-bottom: 1rem;
            padding-bottom: 1rem;
            border-bottom: 1px solid rgba(0, 0, 0, 0.05);
            text-align: center;
        }
        
        .tooltip-content {
            font-family: 'ZCOOL XiaoWei', serif;
            font-size: 1.4rem;
            line-height: 1.6;
        }
        
        .tooltip-item {
            margin-bottom: 0.8rem;
            display: flex;
        }
        
        .tooltip-label {
            color: rgba(26, 26, 26, 0.7);
            min-width: 80px;
            flex-shrink: 0;
        }
        
        .tooltip-value {
            color: #1a1a1a;
            flex: 1;
        }
        
        .tooltip-note {
            margin-top: 1rem;
            padding-top: 1rem;
            border-top: 1px solid rgba(0, 0, 0, 0.05);
            font-size: 1.2rem;
            color: rgba(26, 26, 26, 0.6);
            text-align: center;
            font-style: italic;
        }
        
        /* 修复导航栏链接点击 */
        .nav-link[href^="http"], 
        .nav-link[href$=".html"] {
            cursor: pointer;
            pointer-events: auto;
        }
        
        /* 确保页面链接不会被覆盖 */
        .page-link {
            cursor: pointer;
            pointer-events: auto;
        }
        
        /* 修复太极八卦区域的鼠标事件 */
        .bagua-container * {
            pointer-events: auto;
        }
        
        /* 修复水境区域的链接 */
        .explore-btn {
            pointer-events: auto;
            cursor: pointer;
        }
        
        /* 响应式调整 */
        @media (max-width: 900px) {
            .time-tooltip {
                width: 280px;
                padding: 1.8rem;
            }
        }
        
        @media (max-width: 768px) {
            .time-tooltip {
                width: 260px;
                padding: 1.5rem;
                right: -50%;
            }
        }
        
        @media (max-width: 480px) {
            .time-tooltip {
                width: 240px;
                padding: 1.3rem;
                right: -60%;
            }
        }
    </style>
</head>
<body>
    <!-- 页面水墨过渡效果 -->
    <div class="page-transition"></div>
    
    <!-- 水墨背景 -->
    <div class="ink-bg"></div>
    
    <!-- 水墨装饰点 -->
    <div class="ink-dot ink-dot-1"></div>
    <div class="ink-dot ink-dot-2"></div>
    
    <!-- 顶部导航栏 -->
    <nav class="top-nav">
        <h1 class="site-name">观雪斋</h1>
        
        <div class="nav-section">
            <div class="nav-links">
                <a href="#water" class="nav-link">水境</a>
                <a href="#philosophy" class="nav-link">哲思</a>
                <a href="#journey" class="nav-link">旅程</a>
                <a href="contact.html" class="nav-link">联系</a>
            </div>
            
            <!-- 古代时辰时间显示 -->
            <div class="ancient-time" id="ancientTime">
                <span id="lunarDate"></span>
                <span class="time-separator">|</span>
                <span id="ancientHour"></span>
                
                <!-- 时间悬浮框 -->
                <div class="time-tooltip" id="timeTooltip">
                    <div class="tooltip-header">今日详细信息</div>
                    <div class="tooltip-content">
                        <div class="tooltip-item">
                            <span class="tooltip-label">农历日期：</span>
                            <span class="tooltip-value" id="detailLunarDate"></span>
                        </div>
                        <div class="tooltip-item">
                            <span class="tooltip-label">公历日期：</span>
                            <span class="tooltip-value" id="detailSolarDate"></span>
                        </div>
                        <div class="tooltip-item">
                            <span class="tooltip-label">天干地支：</span>
                            <span class="tooltip-value" id="detailGanzhi"></span>
                        </div>
                        
                        <!-- <div class="tooltip-item">
                            <span class="tooltip-label">值日星宿：</span>
                            <span class="tooltip-value" id="detailStar"></span>
                        </div> -->
                    </div>
                    <div class="tooltip-note">观雪斋·别绪雪</div>
                </div>
            </div>
        </div>
    </nav>
    
    <!-- 主要内容区域 -->
    <main class="main-container">
        <!-- 太极八卦图 -->
        <div class="bagua-container">
            <!-- 太极图 -->
            <div class="taiji"></div>
            
            <!-- 八卦符号外圈 -->
            <div class="bagua-ring" id="baguaRing">
                <!-- 八卦文字和符号通过JavaScript添加 -->
            </div>
        </div>
        
        <!-- 八卦详情面板 -->
        <div class="bagua-detail" id="baguaDetail">
            <div class="detail-header">
                <div class="detail-name" id="detailName">乾</div>
                <div class="detail-symbol" id="detailSymbol">☰</div>
            </div>
            <div class="detail-content">
                <div class="detail-item"><strong>自然象征：</strong><span id="detailNature"></span></div>
                <div class="detail-item"><strong>五行属性：</strong><span id="detailElement"></span></div>
                <div class="detail-item"><strong>方位：</strong><span id="detailDirection"></span></div>
                <div class="detail-item"><strong>特性：</strong><span id="detailCharacter"></span></div>
                <div class="detail-item"><strong>卦辞：</strong><span id="detailDescription"></span></div>
            </div>
        </div>
        
        <!-- 水境说明文字 -->
        <section class="water-realm" id="water">
            <div class="water-description">
                <p>鹧鸪天·西都作</p>
                <p>我是清都山水郎，天教分付与疏狂。
               曾批给雨支风券，累上留云借月章。</p>
                <p>诗万首，酒千觞。几曾着眼看侯王？
                玉楼金阙慵归去，且插梅花醉洛阳。‌‌</p>
            </div>
            
            <!-- 探索按钮 -->
            <a href="#journey" class="explore-btn">
                <span>探索观雪</span>
                <span class="btn-icon">→</span>
            </a>
        </section>
    </main>
    
    <!-- 底部区域 -->
    <footer class="modern-footer">
        <p class="copyright">© 2026 观雪斋 · 中國傳統文化哲学空间</p>
        <div class="page-links">
            <a href="#" class="page-link">静思</a>
            <a href="#" class="page-link">观水</a>
            <a href="#" class="page-link">问道</a>
        </div>
    </footer>
    
    <!-- 印章 -->
    <div class="seal">
        <div class="seal-text">水境</div>
    </div>
    <script>
        // 八卦数据
        const baguaData = [
            {
                name: "乾", symbol: "☰", nature: "天", element: "金",
                direction: "西北", character: "刚健、自强不息", description: "元亨利贞"
            },
            {
                name: "兑", symbol: "☱", nature: "泽", element: "金",
                direction: "西", character: "喜悦、言说", description: "亨，利贞"
            },
            {
                name: "离", symbol: "☲", nature: "火", element: "火",
                direction: "南", character: "光明、依附", description: "利贞，亨"
            },
            {
                name: "震", symbol: "☳", nature: "雷", element: "木",
                direction: "东", character: "震动、行动", description: "亨，震来虩虩"
            },
            {
                name: "巽", symbol: "☴", nature: "风", element: "木",
                direction: "东南", character: "顺入、谦逊", description: "小亨，利有攸往"
            },
            {
                name: "坎", symbol: "☵", nature: "水", element: "水",
                direction: "北", character: "险陷、流动", description: "有孚，维心亨"
            },
            {
                name: "艮", symbol: "☶", nature: "山", element: "土",
                direction: "东北", character: "停止、静止", description: "艮其背，不获其身"
            },
            {
                name: "坤", symbol: "☷", nature: "地", element: "土",
                direction: "西南", character: "柔顺、包容", description: "元亨，利牝马之贞"
            }
        ];

        // 古代时辰时间显示
        function updateAncientTime() {
            const now = new Date();
            const year = now.getFullYear();
            const month = now.getMonth() + 1;
            const day = now.getDate();
            const hour = now.getHours();
            
            // 使用calendar.js计算农历日期
            const lunarInfo = calendar.solar2lunar(year, month, day);
            
            // 从农历信息中获取月份和日期
            const lunarMonth = lunarInfo.IMonthCn;
            const lunarDay = lunarInfo.IDayCn;    
            
            // 获取时辰
            let ancientHour;
            if (hour >= 23 || hour < 1) ancientHour = '子时';
            else if (hour >= 1 && hour < 3) ancientHour = '丑时';
            else if (hour >= 3 && hour < 5) ancientHour = '寅时';
            else if (hour >= 5 && hour < 7) ancientHour = '卯时';
            else if (hour >= 7 && hour < 9) ancientHour = '辰时';
            else if (hour >= 9 && hour < 11) ancientHour = '巳时';
            else if (hour >= 11 && hour < 13) ancientHour = '午时';
            else if (hour >= 13 && hour < 15) ancientHour = '未时';
            else if (hour >= 15 && hour < 17) ancientHour = '申时';
            else if (hour >= 17 && hour < 19) ancientHour = '酉时';
            else if (hour >= 19 && hour < 21) ancientHour = '戌时';
            else ancientHour = '亥时';
            
            // 更新页面显示
            document.getElementById('lunarDate').textContent = `${lunarMonth}${lunarDay}`;
            document.getElementById('ancientHour').textContent = ancientHour;
            
            // 更新悬浮框内容
            updateTimeTooltip(lunarInfo, ancientHour, now);
        }
        
        // 更新时间悬浮框内容
        function updateTimeTooltip(lunarInfo, ancientHour, now) {
            const year = now.getFullYear();
            const month = now.getMonth() + 1;
            const day = now.getDate();
            
            // 获取节气信息
            // const solarTerm = lunarInfo.Term || '无节气';
            
            // 获取宜忌信息（示例）
            
            
            
            // 星宿数据
            // const starsData = [
            //     '角木蛟 (吉)', '亢金龙 (凶)', '氐土貉 (凶)', '房日兔 (吉)',
            //     '心月狐 (凶)', '尾火虎 (吉)', '箕水豹 (吉)', '斗木獬 (吉)'
            // ];
            
            // const star = starsData[day % starsData.length];
            
            // 更新悬浮框内容
            document.getElementById('detailLunarDate').textContent = 
                `${lunarInfo.gzYear}年 ${lunarInfo.IMonthCn}${lunarInfo.IDayCn} (${lunarInfo.Animal}年)`;
            
            document.getElementById('detailSolarDate').textContent = 
                `${year}年${month}月${day}日`;
            
            document.getElementById('detailGanzhi').textContent = 
                `${lunarInfo.gzYear}年 ${lunarInfo.gzMonth}月 ${lunarInfo.gzDay}日`;
            
            // document.getElementById('detailSolarTerm').textContent = 
            //     solarTerm;
            
            // document.getElementById('detailYiJi').textContent = auspicious;
            
            // document.getElementById('detailStar').textContent = star;
        }
        
        // 初始化八卦文字和符号
        function initBaguaElements() {
            const container = document.getElementById('baguaRing');
            const textRadius = 180;
            const symbolRadius = 240;
            
            baguaData.forEach((item, index) => {
                const angle = (index * 45) * Math.PI / 180;
                const rotateAngle = (angle * 180 / Math.PI) + 90;
                
                // 创建文字元素
                const textElement = document.createElement('div');
                textElement.className = 'bagua-text';
                textElement.textContent = item.name;
                textElement.dataset.index = index;
                textElement.style.left = `calc(50% + ${textRadius * Math.cos(angle)}px)`;
                textElement.style.top = `calc(50% + ${textRadius * Math.sin(angle)}px)`;
                textElement.style.transform = `translate(-50%, -50%) rotate(${rotateAngle}deg)`;
                textElement.style.setProperty('--rotation', `${rotateAngle}deg`);
                
                // 创建符号元素
                const symbolElement = document.createElement('div');
                symbolElement.className = 'bagua-symbol';
                symbolElement.textContent = item.symbol;
                symbolElement.dataset.index = index;
                symbolElement.style.left = `calc(50% + ${symbolRadius * Math.cos(angle)}px)`;
                symbolElement.style.top = `calc(50% + ${symbolRadius * Math.sin(angle)}px)`;
                symbolElement.style.transform = `translate(-50%, -50%) rotate(${rotateAngle}deg)`;
                symbolElement.style.setProperty('--rotation', `${rotateAngle}deg`);
                
                // 鼠标移入显示详情
                textElement.addEventListener('mouseenter', () => showBaguaDetail(index));
                symbolElement.addEventListener('mouseenter', () => showBaguaDetail(index));
                
                // 鼠标移出隐藏详情
                textElement.addEventListener('mouseleave', hideBaguaDetail);
                symbolElement.addEventListener('mouseleave', hideBaguaDetail);
                
                container.appendChild(textElement);
                container.appendChild(symbolElement);
            });
        }
        
        // 显示八卦详情
        function showBaguaDetail(index) {
            const detail = baguaData[index];
            const detailPanel = document.getElementById('baguaDetail');
            
            document.getElementById('detailName').textContent = detail.name;
            document.getElementById('detailSymbol').textContent = detail.symbol;
            document.getElementById('detailNature').textContent = detail.nature;
            document.getElementById('detailElement').textContent = detail.element;
            document.getElementById('detailDirection').textContent = detail.direction;
            document.getElementById('detailCharacter').textContent = detail.character;
            document.getElementById('detailDescription').textContent = detail.description;
            
            detailPanel.classList.add('active');
            
            // 鼠标移入详情面板时保持显示
            detailPanel.addEventListener('mouseenter', () => {
                detailPanel.classList.add('active');
            });
            
            // 鼠标移出详情面板时隐藏
            detailPanel.addEventListener('mouseleave', hideBaguaDetail);
        }
        
        // 隐藏八卦详情
        function hideBaguaDetail() {
            const detailPanel = document.getElementById('baguaDetail');
            detailPanel.classList.remove('active');
        }
        
        // 修复的导航链接处理
        function initNavigation() {
            document.querySelectorAll('.nav-link').forEach(link => {
                link.addEventListener('click', function(e) {
                    const targetId = this.getAttribute('href');
                    
                    // 如果是锚点链接（以#开头且不是.html文件）
                    if(targetId && targetId.startsWith('#') && !targetId.includes('.html')) {
                        e.preventDefault();
                        const targetElement = document.querySelector(targetId);
                        if(targetElement) {
                            window.scrollTo({
                                top: targetElement.offsetTop - 100,
                                behavior: 'smooth'
                            });
                        }
                    }
                    // 对于页面链接（如contact.html），让浏览器正常处理
                    // 对于外部链接，也正常处理
                });
            });
            
            // 底部链接处理
            document.querySelectorAll('.page-link').forEach(link => {
                link.addEventListener('click', function(e) {
                    e.preventDefault();
                    const targetId = this.getAttribute('href');
                    if(targetId === '#') {
                        // 如果是#，平滑滚动到顶部
                        window.scrollTo({
                            top: 0,
                            behavior: 'smooth'
                        });
                    }
                });
            });
            
            // 探索按钮处理
            const exploreBtn = document.querySelector('.explore-btn');
            if(exploreBtn) {
                exploreBtn.addEventListener('click', function(e) {
                    const targetId = this.getAttribute('href');
                    if(targetId && targetId.startsWith('#')) {
                        e.preventDefault();
                        const targetElement = document.querySelector(targetId);
                        if(targetElement) {
                            window.scrollTo({
                                top: targetElement.offsetTop - 100,
                                behavior: 'smooth'
                            });
                        }
                    }
                });
            }
        }
        
        // 页面加载完成后执行
        document.addEventListener('DOMContentLoaded', function() {
            updateAncientTime();
            setInterval(updateAncientTime, 60000);
            
            initBaguaElements();
            initNavigation();
            
            const pageTransition = document.querySelector('.page-transition');
            if(pageTransition) {
                setTimeout(() => pageTransition.remove(), 2000);
            }
            
            // 确保所有链接都能正常工作
            document.addEventListener('click', function(e) {
                // 如果点击的是带有href的链接，确保它能正常工作
                if (e.target.tagName === 'A' && e.target.getAttribute('href')) {
                    const href = e.target.getAttribute('href');
                    // 如果是页面链接，确保它不会被阻止
                    if (href.includes('.html') || href.startsWith('http') || href.startsWith('mailto')) {
                        // 让浏览器正常处理这些链接
                        return;
                    }
                }
            }, true);
        });
    </script>
</body>
</html>